Description: <short summary of the patch>
 TODO: Put a short summary on the line above and replace this paragraph
 with a longer explanation of this change. Complete the meta-information
 with other relevant fields (see below for details). To make it easier, the
 information below has been extracted from the changelog. Adjust it or drop
 it.
 .
 eog (3.33.3-1) unstable; urgency=medium
 .
   * Non-maintainer upload.
   * Add patch to activate and deactivate monitoring
Author: krifa75 <yahiaoui.fakhri@gmail.com>

---
The information above should follow the Patch Tagging Guidelines, please
checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: <vendor|upstream|other>, <url of original patch>
Bug: <url in upstream bugtracker>
Bug-Debian: https://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: <no|not-needed|url proving that it has been forwarded>
Reviewed-By: <name and email of someone who approved the patch>
Last-Update: 2019-09-05

Index: eog-3.33.3/src/eog-thumb-view.c
===================================================================
--- eog-3.33.3.orig/src/eog-thumb-view.c
+++ eog-3.33.3/src/eog-thumb-view.c
@@ -82,6 +82,7 @@ struct _EogThumbViewPrivate {
 	gint n_images;
 	gulong image_add_id;
 	gulong image_removed_id;
+        gulong store_cleared_id;
 };
 
 G_DEFINE_TYPE_WITH_CODE (EogThumbView, eog_thumb_view, GTK_TYPE_ICON_VIEW,
@@ -176,6 +177,11 @@ eog_thumb_view_dispose (GObject *object)
 		priv->image_removed_id = 0;
 	}
 
+	if (model && priv->store_cleared_id) {
+       	        g_signal_handler_disconnect (EOG_LIST_STORE(model), priv->store_cleared_id);
+		priv->store_cleared_id = 0;
+	}
+	
 	G_OBJECT_CLASS (eog_thumb_view_parent_class)->dispose (object);
 }
 
@@ -638,7 +644,7 @@ eog_thumb_view_init (EogThumbView *thumb
 	thumbview->priv->visible_range_changed_id = 0;
 	thumbview->priv->image_add_id = 0;
 	thumbview->priv->image_removed_id = 0;
-
+	thumbview->priv->store_cleared_id = 0;
 }
 
 /**
@@ -695,6 +701,20 @@ eog_thumb_view_row_deleted_cb (GtkTreeMo
 	eog_thumb_view_update_columns (view);
 }
 
+static void
+eog_thumb_view_store_cleared_cb (EogListStore *store,
+				 EogThumbView *view)
+{
+  g_return_if_fail (EOG_IS_THUMB_VIEW (view));
+
+  EogThumbViewPrivate *priv = view->priv;
+  
+  priv->start_thumb = priv->end_thumb = 0;
+
+  priv->n_images = 0;
+  eog_thumb_view_update_columns (view);
+}
+
 /**
  * eog_thumb_view_set_model:
  * @thumbview: A #EogThumbView.
@@ -728,6 +748,11 @@ eog_thumb_view_set_model (EogThumbView *
 			                             priv->image_removed_id);
 
 		}
+		if (priv->store_cleared_id != 0) {
+		  	eog_list_store_clear (EOG_LIST_STORE(existing));
+ 		        g_signal_handler_disconnect (EOG_LIST_STORE(existing),
+			                             priv->store_cleared_id);		  
+		}
 	}
 
 	priv->image_add_id = g_signal_connect (G_OBJECT (store), "row-inserted",
@@ -737,7 +762,11 @@ eog_thumb_view_set_model (EogThumbView *
 	                             "row-deleted",
 	                             G_CALLBACK (eog_thumb_view_row_deleted_cb),
 	                             thumbview);
-
+	priv->store_cleared_id = g_signal_connect (store,
+	                             "clear-list-store",
+	                             G_CALLBACK (eog_thumb_view_store_cleared_cb),
+	                             thumbview);
+	
 	thumbview->priv->n_images = eog_list_store_length (store);
 
 	index = eog_list_store_get_initial_pos (store);
